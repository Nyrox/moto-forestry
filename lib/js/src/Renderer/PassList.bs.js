// Generated by BUCKLESCRIPT, PLEASE EDIT WITH CARE
'use strict';

var List = require("bs-platform/lib/js/list.js");
var Vdom = require("bucklescript-tea/lib/js/src-ocaml/vdom.js");
var Block = require("bs-platform/lib/js/block.js");
var $$Option = require("./Option.bs.js");
var Tea_html = require("bucklescript-tea/lib/js/src-ocaml/tea_html.js");
var Tea_json = require("bucklescript-tea/lib/js/src-ocaml/tea_json.js");

function init(param) {
  return {
          passes: /* [] */0,
          createDialog: undefined
        };
}

function update(model, msg) {
  switch (msg.tag | 0) {
    case /* SetNewFileDialog */0 :
        return /* tuple */[
                {
                  passes: model.passes,
                  createDialog: msg[0]
                },
                /* DoNothing */0
              ];
    case /* CreatePass */1 :
        var name = msg[0];
        if (!($$Option.isSome(model.createDialog) && name.length !== 0)) {
          return /* tuple */[
                  {
                    passes: model.passes,
                    createDialog: undefined
                  },
                  /* DoNothing */0
                ];
        }
        var pass = {
          name: name
        };
        return /* tuple */[
                {
                  passes: /* :: */[
                    pass,
                    model.passes
                  ],
                  createDialog: undefined
                },
                /* OpenPass */[name]
              ];
    case /* DoubleClickPass */2 :
        return /* tuple */[
                model,
                /* OpenPass */[msg[0]]
              ];
    
  }
}

function passItem(pass, active) {
  return Tea_html.li(undefined, undefined, /* :: */[
              Tea_html.classList(/* :: */[
                    /* tuple */[
                      "pass-item",
                      true
                    ],
                    /* :: */[
                      /* tuple */[
                        "active",
                        active
                      ],
                      /* [] */0
                    ]
                  ]),
              /* :: */[
                Tea_html.onDoubleClick(/* DoubleClickPass */Block.__(2, [pass.name])),
                /* [] */0
              ]
            ], /* :: */[
              Tea_html.text(pass.name),
              /* [] */0
            ]);
}

function viewHeader(model) {
  return Tea_html.div(undefined, undefined, /* :: */[
              Tea_html.class$prime("header"),
              /* [] */0
            ], /* :: */[
              Tea_html.h2(undefined, undefined, /* [] */0, /* :: */[
                    Tea_html.text("Passes"),
                    /* [] */0
                  ]),
              /* :: */[
                Tea_html.span(undefined, undefined, /* :: */[
                      Tea_html.class$prime("button"),
                      /* :: */[
                        Tea_html.onClick(/* SetNewFileDialog */Block.__(0, [""])),
                        /* [] */0
                      ]
                    ], /* :: */[
                      Tea_html.text("+"),
                      /* [] */0
                    ]),
                /* [] */0
              ]
            ]);
}

function view(model, active) {
  var v = model.createDialog;
  var createFileDialog = v !== undefined ? ((setTimeout(() => document.querySelector("#pass-list-create-dialog-field").focus(), 1)), Tea_html.form(undefined, undefined, /* :: */[
            Tea_html.onWithOptions(v, "submit", {
                  stopPropagation: Tea_html.defaultOptions.stopPropagation,
                  preventDefault: true
                }, Tea_json.Decoder.succeed(/* CreatePass */Block.__(1, [v]))),
            /* [] */0
          ], /* :: */[
            Tea_html.input$prime(undefined, undefined, /* :: */[
                  Tea_html.type$prime("text"),
                  /* :: */[
                    Tea_html.classList(/* :: */[
                          /* tuple */[
                            "pass-item",
                            true
                          ],
                          /* :: */[
                            /* tuple */[
                              "create-dialog",
                              true
                            ],
                            /* [] */0
                          ]
                        ]),
                    /* :: */[
                      Tea_html.id("pass-list-create-dialog-field"),
                      /* :: */[
                        Tea_html.onBlur(/* CreatePass */Block.__(1, [v])),
                        /* :: */[
                          Tea_html.value(v),
                          /* :: */[
                            Tea_html.onInput(undefined, (function (s) {
                                    return /* SetNewFileDialog */Block.__(0, [s]);
                                  })),
                            /* [] */0
                          ]
                        ]
                      ]
                    ]
                  ]
                ], /* [] */0),
            /* [] */0
          ])) : Vdom.noNode;
  return /* tuple */[
          Tea_html.div(undefined, undefined, /* :: */[
                Tea_html.classList(/* :: */[
                      /* tuple */[
                        "pass-list",
                        true
                      ],
                      /* :: */[
                        /* tuple */[
                          "is-experiencing-input",
                          $$Option.isSome(model.createDialog)
                        ],
                        /* [] */0
                      ]
                    ]),
                /* [] */0
              ], /* :: */[
                viewHeader(model),
                /* :: */[
                  Tea_html.div(undefined, undefined, /* :: */[
                        Tea_html.class$prime("pass-items"),
                        /* [] */0
                      ], List.concat(/* :: */[
                            List.map((function (p) {
                                    return passItem(p, p.name === active);
                                  }), List.rev(model.passes)),
                            /* :: */[
                              /* :: */[
                                createFileDialog,
                                /* [] */0
                              ],
                              /* [] */0
                            ]
                          ])),
                  /* [] */0
                ]
              ]),
          /* :: */[
            Tea_html.noNode,
            /* [] */0
          ]
        ];
}

exports.init = init;
exports.update = update;
exports.passItem = passItem;
exports.viewHeader = viewHeader;
exports.view = view;
/* Tea_html Not a pure module */
